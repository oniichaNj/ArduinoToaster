Copyright (C) 2014 Mark Otz√©n                                                                                                                                                                                         
                                                                                                                                                                                                                      
    This program is free software: you can redistribute it and/or modify                                                                                                                                              
    it under the terms of the GNU General Public License as published by                                                                                                                                              
    the Free Software Foundation, either version 3 of the License, or                                                                                                                                                 
    (at your option) any later version.                                                                                                                                                                               
                                                                                                                                                                                                                      
    This program is distributed in the hope that it will be useful,                                                                                                                                                   
    but WITHOUT ANY WARRANTY; without even the implied warranty of                                                                                                                                                    
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                                                                                                                                     
    GNU General Public License for more details.                                                                                                                                                                      
                                                                                                                                                                                                                      
    You should have received a copy of the GNU General Public License                                                                                                                                               
    along with this program.  If not, see <http://www.gnu.org/licenses/>.                                                                                                                                             


void setup() {
			//We set the 'duinos pins to OUTPUT mode, these do not power the actual motor
			//but rather control it.
		pinMode(10, OUTPUT);
		pinMode(11, OUTPUT);
		pinMode(13, OUTPUT);
			//We write LOW to them, because we don't want to do things yet.
		digitalWrite(10, LOW);
		digitalWrite(11, LOW);

		Serial.begin(9600);
}
int incomingByte = 0;   // for incoming serial data
unsigned long toastingTime = 0;
int relay = 13;
int tmp = 0; 
int waitTimeDown = 1100;
int waitTimeUp = 350;
//In order to spin the motor downwards, write 100 analogue to the 11th pin, and LOW to the 10th one.
//We use 100 because it's a nice slow spin.

void relayOn(){
	digitalWrite(relay, HIGH);
	}
void relayOff(){
	digitalWrite(relay, LOW);

	}
void motorUp(){
	analogWrite(10, 100);
	digitalWrite(11, LOW);
	delay(waitTimeUp);
	digitalWrite(10, LOW);
	
	}
	
void motorDown(){
	analogWrite(11, 100);
	digitalWrite(10, LOW);
	delay(waitTimeDown);
	digitalWrite(11, LOW);
	}

//Main body
void loop() {
digitalWrite(11, LOW);
digitalWrite(10, LOW);
while(!Serial.available());
// read the incoming byte:
toastingTime = Serial.read();
delay(500);
                // say what you got:
Serial.print("I received: ");
Serial.println(toastingTime);
motorDown();
delay(100);
relayOn();
toastingTime = toastingTime * 1000;
Serial.println(toastingTime);
delay(toastingTime);
relayOff();
delay(100);
motorUp();
Serial.println("Motor went up successfully.");
}